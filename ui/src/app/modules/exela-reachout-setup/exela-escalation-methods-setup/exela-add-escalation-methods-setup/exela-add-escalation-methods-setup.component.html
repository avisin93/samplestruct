<div class="component-wrap add-edit-user-setup">
  <div class="heading-wrap">
    <div class="inner">
      <div class="popup-heading">{{heading}}</div>
      <div class="popup-close" (click)="closePopup()">
        <i class="material-icons">close</i>
      </div>
    </div>
  </div>
  <form [formGroup]="addEscalationMethodForm" novalidate>
    <div class="row">
      <div class="col-sm-12 col-xs-12">
        <mat-form-field class="full-width-input-wrap margin-bottom-10">
          <input i18n-placeholder matInput placeholder="Escalation Method*" formControlName="escalationmethod" maxlength="30">
          <mat-error i18n *ngIf="addEscalationMethodForm.controls['escalationmethod'].hasError('required')">
            Escalation Method is
            <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </div>
    </div>
      

        <div class="row">
          <div formArrayName="escalationOrder">
            <div *ngFor="let itemrow of getControls(addEscalationMethodForm, 'escalationOrder'); let i=index;let first = first; 
                let last = last" [formGroupName]="i">
              <div class="col-sm-12 col-xs-12 ">
                <div class="row">
                  <div class="col-sm-4 col-xs-4">
                    <mat-form-field class="mat-select-full-width">
                      <mat-select i18n-placeholder placeholder="Contact Method*" (ngModelChange)="removeContactMethod($event, i)" formControlName="contactmethod" maxlength="50">
                        <mat-option *ngFor="let cmthod of allContactMethods[i].methodArray" [value]="cmthod.value">
                          <div>{{cmthod.text }}</div>
                        </mat-option>
                      </mat-select>
                      <mat-error i18n *ngIf="itemrow.controls['contactmethod'].hasError('required')" [ngStyle]="{'fontSize.px': 11}">
                        Contact Method is <strong>required</strong>
                      </mat-error>
                    </mat-form-field>
                  </div>
                  <div class="col-sm-8 col-xs-8">
                    <div class="row">
                      <div class="col-sm-7 col-xs-7">
                        <mat-form-field class="full-width-input-wrap margin-bottom-15 drop-top">
                          <input i18n-placeholder matInput placeholder="Max Attempts*" formControlName="maxattempts" maxlength="1">
                          <mat-error i18n *ngIf="itemrow.controls['maxattempts'].hasError('required')  && itemrow.controls['maxattempts'].touched">
                            Max Attempts is
                            <strong>required</strong>
                          </mat-error>
                          <mat-error i18n *ngIf="itemrow.controls['maxattempts'].hasError('pattern')">
                            Enter Max Attempt between 1 to 5.
                          </mat-error>
                        </mat-form-field>
                      </div>
                      <div class="col-sm-4 col-xs-4">
                        <div class="col-sm-2 col-xs-2 btn-padding" *ngIf="hideAddBtn && last && addEscalationMethodForm.controls.escalationOrder.controls.length < maxRuleCriterias">
                          <a (click)="addNewRow(addEscalationMethodForm, itemrow.controls['contactmethod'].value, i)" class="fontText" style="cursor:pointer;">
                            <i class="fa fa-plus-circle rule_group_icon fa-2x" aria-hidden="true"></i>
                          </a>
                        </div>
                        <div class="col-sm-2 col-xs-2 btn-padding" *ngIf="addEscalationMethodForm.controls.escalationOrder.controls.length >1">
                          <a (click)="deleteRow(i)" class="fontText" style="cursor:pointer;">
                            <i class="fa fa-trash-o fa-2x" aria-hidden="true"></i>
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        

      </div>
    <div class="btn-position">
      <button i18n type="button" mat-button class="app-btn" id="cancel" (click)="closePopup()">Cancel</button>
      <button i18n type="button" mat-button class="app-btn mat-primary mat-flat-button save-btn" (click)="saveEscalationMethodForm(addEscalationMethodForm)">Save</button>
    </div>

  </form>
</div>