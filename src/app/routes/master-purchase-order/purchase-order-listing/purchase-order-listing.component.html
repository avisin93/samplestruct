<div id="list-purchase-order">
  <div class="content-heading">
    <breadcrumb class="col-12 col-sm-8 col-md-8 col-lg-8 col-xl-8 no-mg" [breadcrumbData]="breadcrumbData"></breadcrumb>
  </div>
  <div class="container-fluid">
    <div class="row no-mg">
      <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 no-mg">
        <div class="panel panel-primary">
          <div class="panel-body">
            <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
              <form [formGroup]="POListFilterForm">
                <div class="row">
                  <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 mb-2">
                    <ngx-select formControlName="projectName" [items]="projectsDropdown" [allowClear]='true'
                      data-placement="top" title="{{'common.labels.projectName' | translate}}"
                      placeholder="{{'common.labels.projectName' | translate}}">
                    </ngx-select>
                  </div>

                  <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 mb-2">
                    <input formControlName="poNumber" data-placement="top" title="{{'payments.labels.po' | translate}}#"
                      type="text" placeholder="{{'payments.labels.po' | translate}}#" class="form-control">
                  </div>
                  <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 mb-2">
                    <ngx-select (typed)="searchSupplierName.next($event)" data-placement="top" [allowClear]='true'
                      title="{{'common.labels.supplierName' | translate}}" formControlName="supplierName"
                      [items]="supplierDropDown" placeholder="{{'common.labels.supplierName' | translate}}">

                      <ng-template ngx-select-option-not-found>
                        <ng-container *ngIf="isLoadingSupplierName; else elseBlock">
                          {{'biddings.labels.loading' | translate}}
                          <span class="fl-right">
                            <i class="fa fa-spinner fa-spin margin-right-5"></i>
                          </span>
                        </ng-container>
                        <ng-template #elseBlock>
                          {{ 'common.labels.recordNotFound' | translate }}
                        </ng-template>
                      </ng-template>
                    </ngx-select>
                  </div>


                  <!-- </div> -->
                  <!-- <div class="row"> -->
                  <div id="date-picker-wrapper" class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4">
                    <my-date-range-picker formControlName="createdOn" data-placement="top"
                      title="{{'common.labels.createdOn' | translate}} ({{'common.labels.dateRange' | translate}})"
                      class="range-picker" [options]="myDateRangePickerOptions" name="mydaterange"
                      placeholder="{{'common.labels.createdOn' | translate}} ({{'common.labels.dateRange' | translate}})">
                    </my-date-range-picker>
                  </div>
                  <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 mb-2">
                    <ngx-select data-placement="top" title="{{'projects.labels.suppType' | translate}}"
                      formControlName="type" [items]="supplierTypeArr" [allowClear]='true'
                      placeholder="{{'projects.labels.suppType' | translate}}">
                    </ngx-select>
                  </div>
                  <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 mb-2">
                    <ngx-select data-placement="top" title="{{'projects.labels.status' | translate}}"
                      formControlName="status" [items]="statusArr" [allowClear]='true'
                      placeholder="{{'projects.labels.status' | translate}}">
                    </ngx-select>
                  </div>


                  <!-- </div> -->
                  <!-- <div class="row"> -->
                  <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 mb-2">
                    <input data-placement="top" title="{{'common.labels.fromAmt' | translate}}"
                      formControlName="fromAmount" type="text" placeholder="{{'common.labels.fromAmt' | translate}}"
                      oninput="this.value = this.value.replace(/[^0-9.]/g,'');" class="form-control redcolor">
                  </div>
                  <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 mb-2">
                    <input data-placement="top" title="{{'common.labels.toAmt' | translate}}" formControlName="toAmount"
                      type="text" oninput="this.value = this.value.replace(/[^0-9.]/g,'');"
                      placeholder="{{'common.labels.toAmt' | translate}}" class="form-control redcolor">
                  </div>
                  <div class="col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4 mb-2">
                    <button (click)="search()" class="btn search-btn btn-primary" type="button"
                      [disabled]="showLoadingFlg || exportSpinnerFlag">
                      {{'common.labels.search'| translate}}</button>
                    <button (click)="clear()" class="btn clear-btn btn-primary" type="button"
                      [disabled]="showLoadingFlg || exportSpinnerFlag">
                      {{'common.labels.clear'| translate}}</button>
                    <button [disabled]="showLoadingFlg || exportSpinnerFlag || disableExportBtn"
                      (click)="downloadExcel()" class="btn clear-btn btn-primary pull-right export-button"
                      type="button">
                      <i *ngIf="exportSpinnerFlag" class="fa fa-spinner fa-spin margin-right-5"></i>
                      <i *ngIf="!exportSpinnerFlag" class="fa fa-file-excel-o ptr mr-2"></i>{{'common.labels.exportExcel'
                      | translate}}
                    </button>
                  </div>
                </div>
                <div class="row mb-3 mt-1">
                  <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 export-btn">
                    <button [disabled]="showLoadingFlg || exportSpinnerFlag || disableExportBtn"
                      (click)="downloadExcel()" class="btn clear-btn btn-primary pull-left" type="button">
                      <i *ngIf="exportSpinnerFlag" class="fa fa-spinner fa-spin margin-right-5"></i>
                      <i *ngIf="!exportSpinnerFlag" class="fa fa-file-excel-o ptr mr-2"></i>{{'common.labels.exportExcel'
                  | translate}}
                    </button>
                  </div>
                </div>
                <div class="row" *ngIf="totalCount">
                  <div class="col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4"><b class=" po-number">({{'projects.labels.totalCount'
                    | translate}}:
                      {{totalCount}})</b></div>
                </div>
              </form>
              <div *ngIf="showLoadingFlg">
                <app-loader class="col-md-12" [loading]="showLoadingFlg"></app-loader>
              </div>
              <ng-container *ngIf="(poDetailsArr?.length == 0) && !showLoadingFlg">
                <div class="row mt-3">
                  <div class="col-md-12 text-center">
                    <p class="text-danger">{{'common.labels.recordNotFound' | translate}}</p>
                  </div>
                </div>
              </ng-container>
              <div class="panel panel-primary">
                <div class="po-list-details">
                  <ng-container *ngFor="let purchaseOrder of poDetailsArr">
                    <div class="items">
                      <div class="row"
                        *ngIf="(purchaseOrder?.projectTypeId!==PROJECT_TYPES.corporate) && (purchaseOrder?.purchaseOrderFor!==PURCHASE_ORDER_CONST.talent)">

                        <div class="col-md-12 text-danger"
                          *ngIf="!purchaseOrder?.palAccepted && !purchaseOrder?.contractAccepted; else showRespectiveMsgs">
                          <span>
                            {{'common.labels.palContractNotAccepted'| translate}}
                          </span>
                        </div>
                        <ng-template #showRespectiveMsgs>
                          <div class="col-md-12 text-danger" *ngIf="!purchaseOrder?.palAccepted">
                            <span>
                              {{'common.labels.palNotAccepted'| translate}}
                            </span>
                          </div>
                          <div class="col-md-12 text-danger" *ngIf="!purchaseOrder?.contractAccepted">
                            <span>
                              {{'common.labels.contractNotAccepted'| translate}}
                            </span>
                          </div>
                        </ng-template>
                      </div>
                      <div class="row">
                        <div class="col-12 col-sm-12 col-md-12 col-lg-10 col-xl-10">
                          <div class="row mb-2">
                            <div class="col-6 col-sm-4 col-md-4 col-lg-4 col-xl-4">
                              <span>
                                <strong>{{'payments.labels.po' | translate}}#:</strong>
                              </span>
                              <span class="consecutive-number">
                                {{ purchaseOrder?.purchaseOrderNumber | fillZero : 3 }}</span>
                            </div>
                            <div class="col-6 col-sm-5 col-md-5 col-lg-5 col-xl-5">
                              <span>
                                <strong>{{'common.labels.projectName' | translate}}:</strong>
                              </span>
                              <span>{{ purchaseOrder?.projectName }}</span>
                            </div>
                            <div class="col-12 col-sm-3 col-md-3 col-lg-3 col-xl-3">
                              <div
                                class="po-status text-center ptr  {{PO_APPROVAL_STATUS_CONST[purchaseOrder?.status]}} "
                                tooltip="PO Status" (click)="openApprovalModal(purchaseOrder)">
                                <span class="">
                                  {{'projects.labels.PO' | translate | uppercase}}-
                                  {{'projects.labels.' + PO_APPROVAL_STATUS_CONST[purchaseOrder?.status] | translate |
                                  uppercase}}
                                  <i class="fa fa-eye"></i>
                                </span>
                              </div>
                              <div class="text-center po-status-reason">
                                <span
                                  *ngIf="((!purchaseOrder?.status || purchaseOrder?.status==PO_APPROVAL_CONST.pending || purchaseOrder?.status==PO_APPROVAL_CONST.generated) &&  (purchaseOrder?.approver?.reasons?.length >= 1))"><u
                                    class="ptr"
                                    (click)="openReasonsModal(purchaseOrder)">{{'projects.labels.pendingReason'| translate}}</u></span>
                                <span
                                  *ngIf="((purchaseOrder?.status==PO_APPROVAL_CONST.rejected) &&  (purchaseOrder?.approver?.reasons?.length >= 1))"><u
                                    class="ptr"
                                    (click)="openReasonsModal(purchaseOrder)">{{'projects.labels.rejectionReason'| translate}}</u></span>
                              </div>
                            </div>
                          </div>
                          <div class="row mb-3">
                            <div class="col-6 col-sm-4 col-md-4 col-lg-4 col-xl-4">
                              <span>
                                <strong>{{'common.labels.type' | translate}}:</strong>
                              </span>
                              <span>
                                {{ 'common.labels.'+PURCHASE_FOR_ORDER_CONST[purchaseOrder?.purchaseOrderFor] |
                                translate }}
                              </span>
                            </div>
                            <div class="col-6 col-sm-5 col-md-5 col-lg-5 col-xl-5">
                              <span>
                                <strong>{{'common.labels.supplier' | translate}}:</strong>
                              </span>
                              <span>{{ purchaseOrder?.supplierName }}
                                ({{ 'common.labels.'+typeKeyArr[purchaseOrder?.supplierType] | translate }})
                              </span>
                            </div>
                            <div class="col-12 col-sm-3 col-md-3 col-lg-3 col-xl-3">
                              <span>
                                <strong>{{'payments.labels.paidVia' | translate}}:</strong>
                              </span>
                              <ng-container *ngIf="purchaseOrder?.thirdPartyVendorName">
                                <span>{{ purchaseOrder?.thirdPartyVendorName }}</span>
                              </ng-container>
                              <ng-container *ngIf="!purchaseOrder?.thirdPartyVendorName">
                                <span>NA</span>
                              </ng-container>
                            </div>
                          </div>
                          <div class="row mb-2">
                            <div class="col-6 col-sm-4 col-md-4 col-lg-4 col-xl-4">
                              <span>
                                <strong>{{'common.labels.createdOn' | translate}}:</strong>
                              </span>
                              <span>{{ purchaseOrder?.orderDate | dateFormat}}</span>
                            </div>
                            <div class="col-6 col-sm-5 col-md-5 col-lg-5 col-xl-5">
                              <span>
                                <strong>{{'projects.labels.createdBy' | translate}}:</strong>
                              </span>
                              <span>{{purchaseOrder?.createdBy ? purchaseOrder?.createdBy : '-' }}</span>
                            </div>
                            <div class="col-12 col-sm-3 col-md-3 col-lg-3 col-xl-3 text-center"
                              *ngIf="((purchaseOrder?.status == PO_APPROVAL_CONST.approved || purchaseOrder?.paymentStatus) && 
                              purchaseOrder?.purchaseOrderFor == PURCHASE_ORDER_CONST.advance && !(purchaseOrder?.status == PO_APPROVAL_CONST.cancelled)); else elseBlock">
                              <div
                                class="po-status text-center {{ (purchaseOrder?.paymentStatus || purchaseOrder?.paymentStatus === 0) ? MASTER_PAYMENT_STATUS_CONST[purchaseOrder?.paymentStatus] : 'pending' }}"
                                tooltip="Payment Status">
                                <span class="">
                                  {{'projects.labels.payment' | translate | uppercase}} -
                                  {{'projects.labels.' + ((purchaseOrder?.paymentStatus || purchaseOrder?.paymentStatus
                                  === 0) ? MASTER_PAYMENT_STATUS_CONST[purchaseOrder?.paymentStatus] : 'pending') |
                                  translate | uppercase }}
                                  <i class="fa fa-eye"></i>
                                </span>
                              </div>
                              <span *ngIf="purchaseOrder?.paymentStatus==MASTER_PAYMENT_APPROVAL_CONST.rejected"><u
                                  class="ptr" (click)="openRejectionModal(purchaseOrder)">{{'common.labels.rejectionReason'
                                  | translate}}</u></span>
                            </div>
                            <ng-template #elseBlock>
                              <div class="col-12 col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                <span>
                                  <strong>{{'common.labels.paymentDate' | translate}}:</strong>
                                </span>
                                <span>{{purchaseOrder?.paymentDate ? (purchaseOrder?.paymentDate | dateFormat) : '-' }}</span>
                              </div>
                            </ng-template>
                          </div>
                          <div class="row mb-2"
                            *ngIf="((purchaseOrder?.status == PO_APPROVAL_CONST.approved || purchaseOrder?.paymentStatus) && 
                          purchaseOrder?.purchaseOrderFor == PURCHASE_ORDER_CONST.advance && !(purchaseOrder?.status == PO_APPROVAL_CONST.cancelled))">
                            <div class="col-6 col-sm-5 col-md-5 col-lg-5 col-xl-5">
                              <span>
                                <strong>{{'common.labels.paymentDate' | translate}}:</strong>
                              </span>
                              <span>{{purchaseOrder?.paymentDate ? (purchaseOrder?.paymentDate | dateFormat) : '-' }}</span>
                            </div>
                          </div>
                          <div class="row">
                            <div
                              class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 action-items center display-inline-block">
                              <div class="display-inline-flex mb-10">
                                <ng-container>
                                  <span (click)="viewPO(purchaseOrder?.id,purchaseOrder?.purchaseOrderFor)">
                                    <i class="fa fa-eye view-icon"></i>{{'projects.labels.viewPo'| translate}}
                                  </span>
                                </ng-container>
                              </div>
                              <div class="display-inline-flex mb-10">
                                <ui-control-permission [fieldName]="'addInvoice'"
                                  [disableProperty]="UI_ACCESS_PERMISSION_CONST.removeActions"
                                  [uiPermissionObj]="uiAccessPermissionsObj">
                                  <ng-container *ngIf="purchaseOrder?.purchaseOrderFor != PURCHASE_ORDER_CONST.advance">
                                    <span
                                      [ngClass]="(purchaseOrder?.canRaiseInvoice && !purchaseOrder?.ownPo) ? '' : 'ptr-disabled'"
                                      (click)="navigateToInvoice(purchaseOrder,purchaseOrder?.canRaiseInvoice)">
                                      <i class="ptr fa fa-file-text-o"
                                        [ngClass]="(purchaseOrder?.canRaiseInvoice && !purchaseOrder?.ownPo) ? '' : 'ptr-disabled'"></i>{{'projects.labels.raisePaymentOrder'|
                                      translate}}
                                    </span>
                                  </ng-container>
                                </ui-control-permission>
                              </div>
                              <div class="display-inline-flex mb-10">

                              </div>
                              <div class="display-inline-flex mb-10">
                                <span *ngIf="purchaseOrder?.purchaseOrderFileUrl">
                                  <a style="color: #656565;text-decoration:none;"
                                    href="{{purchaseOrder?.purchaseOrderFileUrl}}"
                                    download="{{purchaseOrder?.purchaseOrderFileUrl}}"><i
                                      class="fa fa-download download-icon"></i>{{'projects.labels.poWithoutDot'|
                                    translate}}</a>
                                </span>
                              </div>
                              <div class="display-inline-flex mb-10">
                                <span *ngIf="showPalIcon(purchaseOrder) && purchaseOrder?.projectContractFileUrl">
                                  <a style="color: #656565;text-decoration:none;"
                                    href="{{purchaseOrder?.projectContractFileUrl}}"
                                    download="{{purchaseOrder?.projectContractFileUrl}}">
                                    <i class="fa fa-download download-icon"></i>{{'projects.labels.pal'| translate}}</a>
                                </span>
                              </div>

                            </div>
                          </div>
                        </div>
                        <div class="col-12 col-sm-12 col-md-12 col-lg-2 col-xl-2">
                          <div class="amount-details center">
                            <div class="details">
                              <div class="currency">
                                {{ this.currentCurrencyObj?.code ? this.currentCurrencyObj?.code
                                :(purchaseOrder?.currencyCode) }}
                              </div>
                              <div class="amount">
                                <strong>{{getConvertedValue(purchaseOrder?.defaultCurrencyAmount,purchaseOrder?.totalAmount)
                                  | twoDecimal | absolute | numberFormat}}</strong>
                              </div>
                            </div>
                          </div>
                          <div class="approval-details text-center mt-10" [ngSwitch]="purchaseOrder?.approverStatus">
                            <div *ngSwitchCase="PO_APPROVAL_CONST.pending">
                              <span>
                                <strong>{{'projects.labels.nextApprover'| translate}}</strong>
                              </span>
                            </div>
                            <div *ngSwitchCase="PO_APPROVAL_CONST.approved">
                              <span>
                                <strong>{{'projects.labels.finalApprovedBy'| translate}}</strong>
                              </span>
                            </div>
                            <div *ngSwitchCase="PO_APPROVAL_CONST.rejected">
                              <span>
                                <strong>{{'projects.labels.rejectedBy'| translate}}</strong>
                              </span>
                            </div>
                            <div *ngSwitchCase="PO_APPROVAL_CONST.cancelled">
                              <span>
                                <strong>{{'projects.labels.cancelledBy'| translate}}</strong>
                              </span>
                            </div>
                            <div> {{ purchaseOrder?.approverName }}</div>
                            <div>
                              <small>({{ purchaseOrder?.approverRole }})</small>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-container>
                </div>
              </div>
              <div class="row">
                <div class="col-12 text-right">
                  <div class="custom-pagination" *ngIf="(totalItems > itemsPerPage)"
                    [ngClass]="{'hide-content': showLoadingFlg}">
                    <pagination class="pagination-sm" [(ngModel)]="currentPage" [totalItems]="totalItems"
                      [itemsPerPage]="itemsPerPage" [firstText]="'common.labels.first' | translate"
                      [lastText]="'common.labels.last' | translate"
                      [previousText]="'common.labels.previous' | translate"
                      [nextText]="'common.labels.next' | translate" [maxSize]="maxSize" [boundaryLinks]="true"
                      [rotate]="false" (pageChanged)="pageChanged($event)" (numPages)="numPages = $event">
                    </pagination>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="modal  po-approval-modal" bsModal #approvalStatusModal="bs-modal">
            <div class="modal-dialog modal-dialog-centered modal-lg">
              <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                  <p class="modal-title">
                    <strong>PO {{'projects.labels.approvalDetails' | translate}}</strong>
                  </p>
                  <button type="button" class="close ptr" data-dismiss="modal"
                    (click)="approvalStatusModal.hide()">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                  <app-common-approval-hierarchy #commonApprovalModal [listDetails]="purchaseOrderDetails"
                    [projectTypeId]="projectTypeId" [statusKeyArr]="statusKeyArr"
                    [onHoldReasonArrConstant]="onHoldReasons" [otherReasonArrConstant]="OTHER_REASONS"
                    [rejectionReasonArrConstant]="rejectionReasons" [approvalRejectURL]="poApprovalHierarchyURL"
                    [lisType]="LISTING_TYPE.purchaseOrder"></app-common-approval-hierarchy>
                  <!-- <div class="row text-center" *ngIf="(purchaseOrderDetails?.projectTypeId!==PROJECT_TYPES.corporate) && (purchaseOrderDetails?.purchaseOrderFor!==PURCHASE_ORDER_CONST.talent)">
                      <div class="col-md-12 text-danger"
                      *ngIf="!purchaseOrderDetails?.palAccepted && !purchaseOrderDetails?.contractAccepted; else showRespectiveMsgs">
                      <span>
                        {{'common.labels.palContractNotAccepted'| translate}}
                      </span>
                    </div>
                    <ng-template #showRespectiveMsgs>
                      <div class="col-md-12 text-danger" *ngIf="!purchaseOrderDetails?.palAccepted">
                        <span>
                          {{'common.labels.palNotAccepted'| translate}}
                        </span>
                      </div>
                      <div class="col-md-12 text-danger" *ngIf="!purchaseOrderDetails?.contractAccepted">
                        <span>
                          {{'common.labels.contractNotAccepted'| translate}}
                        </span>
                      </div>
                    </ng-template>
                  </div>
                  <div class="approval-status-bar">
                    <div class="progress" style="width:450px;">
                      <div class="progress-bar" style="width:450px;background:#bbbbbb;">
                        <div class="progress-value approved"
                          tooltip="{{('common.labels.generated'| translate) | titlecase}}" placement="right"
                          [ngStyle]="{'left' : 'calc(0% - 15px)'}">
                          <span>
                            <i class="fa fa-check"></i>
                          </span>
                        </div>
                        <div class="approver-name" [ngStyle]="{'left' : 'calc(0% - 5px)'}">
                          <div>{{('common.labels.generated'| translate) | titlecase}}</div>
                        </div>

                        <ng-container
                          *ngFor="let approval of approvalHierarchyArr; let srNo = index; let first = first">
                          <div class="progress-value {{PO_APPROVAL_STATUS_CONST[approval?.status] | lowercase}}"
                            [ngSwitch]="approval?.status"
                            tooltip="{{('projects.labels.' + PO_APPROVAL_STATUS_CONST[approval?.status] | translate) | titlecase}}"
                            placement="right" [ngStyle]="{'left' : 'calc(' + approval?.percent + '% - 15px)'}"
                            [ngClass]="updateProgressStyle ? 'single-status' : ''">
                            <span *ngSwitchCase="PO_APPROVAL_CONST.approved">
                              <i class="fa fa-check"></i>
                            </span>
                            <span *ngSwitchCase="PO_APPROVAL_CONST.autoapproved">
                              <i class="fa fa-check"></i>
                            </span>
                            <span *ngSwitchCase="PO_APPROVAL_CONST.pending">
                              <i class="fa fa-question"></i>
                            </span>
                            <span *ngSwitchCase="PO_APPROVAL_CONST.cancelled">
                              <i class="fa fa-ban"></i>
                            </span>
                            <span *ngSwitchCase="PO_APPROVAL_CONST.rejected">
                              <i class="fa fa-remove"></i>
                            </span>
                          </div>
                          <div class="approver-name" [ngStyle]="{'left' : 'calc(' + approval?.percent + '% - 5px)'}">
                            <div>{{ approval?.approverName }}</div>
                            <div *ngIf="approval?.approverRole">
                              <small>({{ approval?.approverRole }})</small>
                            </div>
                          </div>
                        </ng-container>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 text-center mt-20"
                    *ngIf="((purchaseOrderDetails?.status===PO_APPROVAL_CONST.pending || purchaseOrderDetails?.status===PO_APPROVAL_CONST.generated) && (purchaseOrderDetails?.approverId==userInfo.id))">
                    <div class="form-group">
                      <label>
                        <strong>
                          {{'projects.labels.poApprovalWaiting'| translate}}
                        </strong>
                      </label>
                    </div>
                    <div class="form-group">
                      <button class="btn btn-warning" [disabled]="disableButtonFlag"
                        (click)="showReasons('pending')">{{'projects.labels.onHold'| translate}}</button>
                      <button [disabled]="disableButtonFlag" class="btn btn-success" (click)="approvePO()">
                        <i *ngIf="approvedSpinnerFlag"
                          class="fa fa-spinner fa-spin margin-right-5"></i>{{'common.labels.approve'| translate}}</button>
                      <button class="btn btn-danger ml-1" [disabled]="disableButtonFlag"
                        (click)="showReasons('reject')">{{'common.labels.reject'| translate}}</button>
                    </div>
                  </div>
                  <ng-container *ngIf="showReasonsBox">
                    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-20  reason-section">
                      <h4 class="text-center"> <u>
                          {{(selectedStatus == 'pending') ? ('projects.labels.onHoldeReason'| translate):('projects.labels.rejectionReason'| translate)}}</u>
                      </h4>
                      <form [formGroup]="reasonsForm">
                        <ng-container *ngIf="(selectedStatus === 'pending');else elseBlock">
                          <ng-container formArrayName="onHoldReasonsArr"
                            *ngFor="let item of reasonsForm['controls'].onHoldReasonsArr['controls']; let index=index;let lst=last">
                            <ng-container [formGroupName]="index">
                              <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 no-mg">
                                <div class="form-check mb-2 mr-sm-2">
                                  <div class="checkbox c-checkbox">
                                    <label>
                                      <input formControlName="selected" type="checkbox" class="ptr" value="1"
                                        name="check" (click)="selectReason(item,$event)" />
                                      <span class="fa fa-check"></span> {{item?.value?.text}}</label>
                                  </div>
                                </div>
                              </div>
                            </ng-container>
                          </ng-container>
                        </ng-container>
                        <ng-template #elseBlock>
                          <ng-container formArrayName="rejectionReasonsArr"
                            *ngFor="let item of reasonsForm['controls'].rejectionReasonsArr['controls']; let index=index;let lst=last">
                            <ng-container [formGroupName]="index">
                              <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 no-mg">
                                <div class="form-check mb-2 mr-sm-2">
                                  <div class="checkbox c-checkbox">
                                    <label>
                                      <input formControlName="selected" type="checkbox" class="ptr" value="1"
                                        name="check" (click)="selectReason(item,$event)" />
                                      <span class="fa fa-check"></span> {{item?.value?.text}}</label>
                                  </div>
                                </div>
                              </div>
                            </ng-container>
                          </ng-container>
                        </ng-template>


                        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 text-center mb-2"
                          *ngIf="reasonsForm?.value?.showOthersReason">
                          <textarea placeholder="Reason" formControlName="othersReason" class="form-control ml-1"
                            rows="3"></textarea>
                        </div>
                        <div class="text-danger col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"
                          *ngIf="!reasonsForm?.value?.showOthersReason && showSelectAtLeastOneReasonMsg">
                          {{'projects.errorMessages.pleaseSelectOneReasonMsg'| translate}}</div>
                        <div class="text-danger col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"
                          *ngIf="reasonsForm?.value?.showOthersReason && reasonsForm.controls['othersReason']?.errors?.checkRequired && (reasonsForm.controls['othersReason']?.touched || submittedReasonFlag)">
                          {{'actors.freelancers.errorMessages.fieldRequired'| translate}}</div>

                        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12  mt-20  text-center">
                          <div class="form-group">
                            <button class="btn btn-success" [disabled]="disableButtonFlag" (click)="submitReason()">
                              <i *ngIf="submitSpinnerFlag"
                                class="fa fa-spinner fa-spin margin-right-5"></i>{{'common.labels.submit'| translate}}</button>
                            <button class="btn btn-danger ml-1" [disabled]="disableButtonFlag"
                              (click)="hideReasons()">{{'common.labels.cancel'| translate}}</button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </ng-container> -->
                </div>
              </div>
            </div>
          </div>

          <div class="modal payment-approval-modal" bsModal #paymentApprovalStatusModal="bs-modal">
            <div class="modal-dialog modal-dialog-centered modal-lg">
              <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                  <p class="modal-title">
                    <strong>{{'projects.labels.paymentApprovalDetails'| translate}}</strong>
                  </p>
                  <button type="button" class="close ptr" data-dismiss="modal"
                    (click)="paymentApprovalStatusModal.hide()">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                  <div class="approval-status-bar">
                    <div class="progress" [ngClass]="(paymentApprovalHierarchyArr?.length > 1) ? '' : 'w-0'">
                      <div class="progress-bar">
                        <ng-container
                          *ngFor="let approval of paymentApprovalHierarchyArr; let srNo = index; let first = first">
                          <div class="progress-value {{PO_APPROVAL_STATUS_CONST[approval?.status] | lowercase}}"
                            [ngSwitch]="approval?.status"
                            tooltip="{{('projects.labels.' + PO_APPROVAL_STATUS_CONST[approval?.status] | translate) | titlecase}}"
                            placement="right" [ngStyle]="{'left' : 'calc(' + approval?.percent + '% - 15px)'}"
                            [ngClass]="updateProgressStyle ? 'single-status' : ''">
                            <span *ngSwitchCase="PO_APPROVAL_CONST.approved">
                              <i class="fa fa-check"></i>
                            </span>
                            <span *ngSwitchCase="PO_APPROVAL_CONST.autoapproved">
                              <i class="fa fa-check"></i>
                            </span>
                            <span *ngSwitchCase="PO_APPROVAL_CONST.pending">
                              <i class="fa fa-question"></i>
                            </span>
                            <span *ngSwitchCase="PO_APPROVAL_CONST.cancelled">
                              <i class="fa fa-ban"></i>
                            </span>
                            <span *ngSwitchCase="PO_APPROVAL_CONST.rejected">
                              <i class="fa fa-remove"></i>
                            </span>
                          </div>
                          <div class="approver-name" [ngStyle]="{'left' : 'calc(' + approval?.percent + '% - 5px)'}">
                            <div>{{ approval?.approverName }}</div>
                            <div *ngIf="approval?.approverRole">
                              <small>({{ approval?.approverRole }})</small>
                            </div>
                          </div>
                        </ng-container>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 text-center mt-20"
                    *ngIf="(!(purchaseOrderDetails?.paymentStatus || purchaseOrderDetails?.paymentStatus === PAYMENT_APPROVAL_CONSTANTS.scheduled) && (purchaseOrderDetails?.approverId==userInfo.id))">
                    <div class="form-group">
                      <label>
                        <strong>
                          {{'projects.labels.paymentApprovalWaiting'| translate}}
                        </strong>
                      </label>
                    </div>
                    <div class="form-group">
                      <button [disabled]="disableButtonFlag" class="btn btn-success" (click)="approvePayment()">
                        <i *ngIf="approvedSpinnerFlag"
                          class="fa fa-spinner fa-spin margin-right-5"></i>{{'common.labels.approve'| translate}}</button>
                      <button [disabled]="disableButtonFlag" class="btn btn-danger ml-1"
                        (click)="showReasonBox=!showReasonBox">{{'common.labels.reject'| translate}}</button>
                    </div>
                  </div>

                  <div class="row" *ngIf="showReasonBox">
                    <div class="col-md-2">
                      <span class="pull-right">{{'common.labels.reason'| translate}}:
                        {{reason?.errors?.required}}</span></div>
                    <div class="col-md-8">
                      <textarea class="form-control ml-1" #reason="ngModel" [(ngModel)]="rejectionReason" rows="3"
                        required></textarea>

                      <div class="text-danger col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 no-mg"
                        *ngIf="reason?.errors?.required && (reason.dirty || reason.touched || submittedReasonFlag)">
                        {{'actors.freelancers.errorMessages.fieldRequired'| translate}}</div>
                    </div>
                  </div>
                  <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 text-center mt-20" *ngIf="showReasonBox">
                    <div class="form-group">
                      <button [disabled]="disableButtonFlag" class="btn btn-success" (click)="rejectPayment()">
                        <i *ngIf="submitSpinnerFlag"
                          class="fa fa-spinner fa-spin margin-right-5"></i>{{'common.labels.ok'| translate}}</button>
                      <button [disabled]="disableButtonFlag" class="btn btn-danger ml-1"
                        (click)="cancelPaymentRejection()">{{'common.labels.cancel'| translate}}</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal" bsModal #rejectModal="bs-modal">
            <div class="modal-dialog modal-dialog-centered modal-md">
              <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                  <p class="modal-title">
                    <strong>{{'common.labels.rejectionReason' | translate}}</strong>
                  </p>
                  <button type="button" class="close ptr" data-dismiss="modal"
                    (click)="rejectModal.hide()">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                  <div class="row">
                    <div class="col-2">{{'common.labels.reason' | translate}}:</div>
                    <div class="col-8">
                      <textarea disabled class="form-control"
                        placeholder="{{'projects.labels.detailsIncomplete' | translate}}"
                        rows="3">{{paymentRejectionReason}}</textarea>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal" bsModal #reasonsModal="bs-modal">
            <div class="modal-dialog modal-dialog-centered modal-md">
              <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                  <p class="modal-title">
                    <strong>{{((purchaseOrderDetails?.status===PO_APPROVAL_CONST.pending) || (purchaseOrderDetails?.status===PO_APPROVAL_CONST.generated)) ? ('projects.labels.pendingReasons'| translate):('projects.labels.rejectionReasons'| translate)}}</strong>
                  </p>
                  <button type="button" class="close ptr" data-dismiss="modal"
                    (click)="reasonsModal.hide()">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                  <div class="row">
                    <ng-container *ngFor="let reason of purchaseOrderDetails?.approver?.reasons;let srNo = index;">
                      <div class="col-12 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <span>{{srNo+1}}.</span>
                        <span
                          *ngIf="((reason?.id != OTHER_REASONS.onhold)&&(reason?.id != OTHER_REASONS.rejection));else showOtherLabel">
                          {{ ((purchaseOrderDetails?.status===PO_APPROVAL_CONST.pending) || (purchaseOrderDetails?.status===PO_APPROVAL_CONST.generated)) ?('projects.reasons.onholdPO.' +
                          onHoldReasonsKeyArr[reason?.id] | translate) :('projects.reasons.rejectPO.' +
                          rejectionReasonsKeyArr[reason?.id] | translate) }}</span>
                        <ng-template #showOtherLabel>
                          <span>{{reason?.text}}</span>
                        </ng-template>
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>